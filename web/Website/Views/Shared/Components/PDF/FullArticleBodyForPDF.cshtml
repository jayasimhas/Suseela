@using Informa.Library.Utilities.References
@using Informa.Web.Models
@using Sitecore.Resources.Media
@inherits CustomGlassView<Informa.Web.ViewModels.PDF.ArticleBodyForPDFViewModel>

<div class="article-body-content">
    <div class="article-metadata">
        <table>
            <tr>
                <td style="float: left; font-size: 16px; line-height: 25px; border-right:1px solid #5a5758; padding:0 10px 0 0; font-weight: 700;">
                    <span class="article-metadata__date">@Model.Date.ToString("dd MMM yyyy")</span>
                </td>
                @if (!string.IsNullOrEmpty(Model.ContentType))
            {
                    <td style="float: left; font-size: 16px; line-height: 25px;  border-right:1px solid #5a5758; padding:0 10px 0 10px; font-weight: 700;">
                        <span class="article-content-type">@Model.ContentType</span>
                    </td>
                }

                @foreach (var tag in Model.ArticleTagsViewModel.Tags)
                {
                    if (tag.LinkableText != Model.ArticleTagsViewModel.Tags.Last().LinkableText)
                    {
                        <td style="float: left; font-size: 16px; line-height: 25px;  border-right:1px solid #5a5758; padding:0 10px 0 10px; font-weight: 700;">
                            <a style="color:#be1e2d; text-decoration:none;" href="@tag.LinkableUrl">@tag.LinkableText</a>
                        </td>
                    }
                    else
                    {

                        <td style="float: left; font-size: 16px; line-height: 25px; padding:0 10px 0 10px; font-weight: 700;">
                            <a style="color:#be1e2d; text-decoration:none;" href="@tag.LinkableUrl">@tag.LinkableText</a>
                        </td>
                    }

                }
            </tr>
        </table>
        <h1><a class="article-title" style="color:#be1e2d; text-decoration:none;" href="@Model.ArticleLandingPageUrl">@Html.Raw(Model.Title)</a></h1>
        <h3>@Html.Raw(Model.Sub_Title)</h3>
    </div>

    @* MULTIPLE AUTHORS *@
    @{
        var authors = Model.Authors.Take(3).ToArray();
    }
    @if (authors.Length == 1)
    {
        var author = authors.FirstOrDefault();
        @* SINGLE AUTHOR*@
        <div class="article-author article-author--solo">
            <table>
                <tr class="article-author__list">

                    <td class="article-author__solo-wrapper" style="color:#58595b; text-decoration:none; padding: 0 0 20px 0; white-space: nowrap;">
                        <span>
                            by
                            @if (author.InActive)
                            {
                                @author.Name
                            }
                            else
                            {
                                <a style="color:#58595b; text-decoration:none;" href="@author.AuthorLink">@author.Name</a>
                            }
                        </span>
                        <span class="article-author__contact" style="color:#be1e2d; text-decoration:none;">
                            <table cellpadding="0" cellspacing="0">
                                <tr><td height="10">&nbsp;</td></tr>
                                <tr>
                                    <td style="padding:0 10px 0 0;">
                                        @if (!string.IsNullOrEmpty(author.Twitter))
                                        {
                                            <a style="color:#be1e2d; text-decoration:none;" href="http://www.twitter.com/@author.Twitter" target="_blank" class="click-utag" data-info='{"event_name" : "author-twitter"}'>&#64;@author.Twitter</a>
                                        }
                                    </td>

                                    <td style="width: 10px;"></td>
                                    <td style="border-left:1px solid #5a5758;"></td>
                                    <td style="width: 10px;"></td>
                                    <td style="padding:0 10px 0 10px;">

                                        @if (!string.IsNullOrEmpty(author.Email_Address))
                                        {
                                            <a style="color:#be1e2d; text-decoration:none;" href="mailto:@author.Email_Address" class="click-utag" data-info='{"event_name" : "mail-to-author"}'>@author.Email_Address</a>
                                        }
                                    </td>
                                </tr>
                            </table>
                        </span>
                    </td>
                </tr>
                <tr><td>&nbsp;</td></tr>
            </table>
        </div>
        <table>
            <tr><td>  <img src="/~/media/Icons/PDF%20Icons/borderline.gif" alt="border-line" /> </td></tr>
            <tr><td>&nbsp;</td></tr>
        </table>

        @* END SINGLE AUTHOR *@

    }
    else if (authors.Length > 1)
    {
        <div class="article-author">
            <table>

                @foreach (var author in authors)
                {
                    <tr class="article-author__list">
                        <span>by</span>
                        <td>
                            @if (author.InActive)
                            {
                                @author.Name
                            }
                            else
                            {
                                <a style="color:#58595b; text-decoration:none;" href="@author.AuthorLink">@author.Name</a>
                                @*<span class="article-author__name" style="color:#58595b; text-decoration:none; padding: 0 0 20px 0;"><a href="@author.AuthorLink">@author.Name</a></span>*@
                            }

                            <span class="article-author__contact" style="color:#be1e2d; text-decoration:none;">
                                <table cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td style="border-right:1px solid #5a5758;  padding:0 10px 0 0;">
                                            @if (!string.IsNullOrEmpty(author.Twitter))
                                            {
                                                <a style="color:#be1e2d; text-decoration:none;" href="http://www.twitter.com/@author.Twitter" target="_blank" class="click-utag" data-info='{"event_name" : "author-twitter"}'>&#64;@author.Twitter</a>
                                            }
                                        </td>

                                        <td style="width: 10px;"></td>
                                        <td style="border-left:1px solid #5a5758;"></td>
                                        <td style="width: 10px;"></td>
                                        <td style="padding:0 10px 0 10px;">

                                            @if (!string.IsNullOrEmpty(author.Email_Address))
                                            {
                                                <a style="color:#be1e2d; text-decoration:none;" href="mailto:@author.Email_Address" class="click-utag" data-info='{"event_name" : "mail-to-author"}'>@author.Email_Address</a>
                                            }
                                        </td>
                                    </tr>
                                </table>
                            </span>
                        </td>
                    </tr>
                }

            </table>
        </div>
        @* END MULTIPLE AUTHORs *@
    }

    @* If plugin created summary for article, it's the same as first paragraph... so hide summary. *@
    @if (!string.IsNullOrEmpty(Model.Summary) && !Model.Body.Contains(Model.Summary))
    {
        @* * * Executive Summary *@
        <div class="article-executive-summary">
            <h4 style="font-size:24px; font-weight:700; margin-bottom:0; padding:0;">@Model.ExecutiveSummary</h4>
            <p style="font-size:18px; line-height:30px; color:#58595b;">@Html.Raw(Html.TokenTransform().RenderCompanyLink(x => x.Summary))</p>
        </div>
        @* End Executive Summary  *@
    }

    @if (!Model.IsEntitled() && Model.CallToActionViewModel != null)
    {
        //This will show context for subscribe, login, register
        <div class="article-call-to-action">
            @{ Html.RenderPartial("../Article/UserCallToAction", Model.CallToActionViewModel); }
        </div>
                }

    @if (Model.Image != null && !string.IsNullOrEmpty(Model.Image.ImageUrl))
    {
        @* * *  ARTICLE - FEATURED IMAGE
            IIPP-117 *@
        <div class="article-inline-image" style="float: left; padding-right: 40px; width:500px;">
            <img src="@Model.Image.GetScaledImage(790)" alt="@Model.Image.ImageAltText">
            <table width="100%">
                <tr><td>&nbsp;</td></tr>
                <tr>
                    <td align="left">
                        <span class="article-inline-image__caption" style="text-align:left; color:#58595b; font-size:18px; line-height:30px;">@Model.Image.ImageCaption</span>
                    </td>
                    <td align="right">
                        @if (!string.IsNullOrEmpty(Model.Image.ImageSource))
                {

                            <span class="article-inline-image__source" style="text-align:right; font-style:italic; color:#58595b; font-size:18px; line-height:30px;">
                                @Model.FeaturedImageSource @Model.Image.ImageSource
                            </span>}
                    </td>
                </tr>
            </table>

        </div>
        @* * *  END ARTICLE - FEATURED IMAGE *@
    }
    <span>
        @Html.Raw(Html.TokenTransform().RenderTokenBody(x => x.Body, "../Article/_ArticleSidebar"))
    </span>

</div>
@if (Model.RelatedArticles != null && Model.RelatedArticles.Any())
{
    <table>
        <tr><td>&nbsp;</td></tr>
        <tr><td><img src="/~/media/Icons/PDF%20Icons/borderline.gif" alt="border-line" /> </td></tr>
        <tr><td>&nbsp;</td></tr>
    </table>
    <div class="article-related-content">
        <h2>Related Content</h2>
        <table width="100%">
            @foreach (var article in Model.RelatedArticles)
            {
                Html.RenderPartial("/Views/Shared/Components/PDF/PDFRelatedArticles.cshtml", article);
            }
        </table>
    </div>
}
<table>
    <tr><td>&nbsp;</td></tr>
    <tr><td><img src="/~/media/Icons/PDF%20Icons/borderline.gif" alt="border-line" /> </td></tr>
    <tr><td>&nbsp;</td></tr>
</table>